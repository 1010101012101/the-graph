<link rel="import" href="../the-graph-inports/the-graph-inports.html">
<link rel="import" href="../the-graph-outports/the-graph-outports.html">
<polymer-element name="the-graph-process" attributes="label x y component">

  <template>
    <div class="the-graph-process">
      <h1 title="{{component}}">{{label}}</h1>
      <content select="the-graph-inports"></content>
      <content select="the-graph-outports"></content>
    </div>
  </template>

  <script type="text/javascript" src="../the-graph-util/the-graph-util.js"></script>

  <script>
  (function() {

    Polymer('the-graph-process', {
      created: function () {
        this.style.position = 'absolute';
        theGraph.transform(this, this.x, this.y);
      },
      label: '',
      x: 0,
      y: 0,
      xChanged: function () {
        this.positionChanged();
      },
      yChanged: function () {
        this.positionChanged();
      },
      positionDebounce: null,
      positionChanged: function () {
        var self = this;
        var later = function(){
          self.positionDebounce = null;
          theGraph.transform(self, self.x, self.y);
          self.fire('moved', {
            x: self.x,
            y: self.y
          });
        }
        clearTimeout(this.positionDebounce);
        this.positionDebounce = setTimeout(later, 16);
      }
      // positionChanged: theGraph.debounce(
      //   function () {
      //     theGraph.transform(this, this.x, this.y);
      //     this.fire('moved', {
      //       x: this.x,
      //       y: this.y
      //     });
      //   },
      //   16
      // )

    });

  })();
  </script>
</polymer-element>

