<polymer-element name="the-graph-port" attributes="name type side" lightdom>
  <template>
    <label>{{name}}</label>
  </template>
  <script>
    Polymer('the-graph-port', {
      name: '',
      type: 'all',
      side: 'west',
      enteredView: function () {
        if (this.parentNode.nodeName === 'THE-GRAPH-OUTPORTS') {
          this.side = 'east';
        }
        this.sideChanged();
      },
      getCentering: function () {
        var onSameSide = [];
        var childNodes = Array.prototype.slice.call(this.parentNode.childNodes);
        childNodes.forEach(function (port) {
          if (port.side === this.side) {
            onSameSide.push(port);
          }
        }.bind(this));
        var spaceForPort = 40 / onSameSide.length;
        var portPosition = spaceForPort * (onSameSide.indexOf(this) + 1);
        return portPosition;
      },
      sideChanged: function () {
        var margin = '-8px';
        var centering = this.getCentering() + '%';
        this.style.top = '';
        this.style.bottom = '';
        this.style.right = '';
        this.style.left = '';
        switch (this.side) {
          case 'east':
            this.style.right = margin;
            this.style.top = centering;
            break;
          case 'south':
            this.style.bottom = margin;
            this.style.left = centering;
            break;
          case 'west':
            this.style.left = margin;
            this.style.top = centering;
            break;
          case 'north':
            this.style.top = margin;
            this.style.left = centering;
            break;
        }
      }
    });
  </script>
</polymer-element>
